import xml.etree.ElementTree as ET
from openpyxl import Workbook

# Change this to the path of your XML file
xml_file_path = 'xml.xml'


# Parse the XML data
tree = ET.parse(xml_file_path)
root = tree.getroot()

# Create a new workbook and add a worksheet
wb = Workbook()
ws = wb.active

# Add header row
header = ['contenId', 'levelId', 'levelGuid', 'moduleId', 'parentId', 'Field_id', 'Field_guid', 'Field_type', 'Field_value', 'ListValue_id', 'ListValue_displayName', 'ListValue_value']
ws.append(header)

# Iterate through the XML records and add rows to the worksheet
for record in root.findall('Record'):
    base_data = [record.get(attr) for attr in ['contenId', 'levelId', 'levelGuid', 'moduleId', 'parentId']]
    for field in record.findall('Field'):
        field_data = [field.get(attr) for attr in ['id', 'guid', 'type']]
        value = field.text if field.text else ''
        row_data = base_data + field_data + [value, '', '', '']
        ws.append(row_data)
        for list_value in field.findall('ListValues/ListValue'):
            list_value_data = [list_value.get(attr) for attr in ['id', 'displayName']]
            value = list_value.text if list_value.text else ''
            row_data = base_data + field_data + ['', list_value_data[0], list_value_data[1], value]
            ws.append(row_data)

# Save the workbook to an XLSX file
wb.save('output.xlsx')
